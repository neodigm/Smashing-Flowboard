ported to ruby

Dave Grant
https://gist.github.com/seize-the-dave/d12bc2f9778362a36576a4cb42b20db2
